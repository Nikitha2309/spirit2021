<!DOCTYPE html>
<html>
    <head>
		<!-- SPIRIT LOGO -->
     <link rel="shortcut icon" type="image/png" href="images/logo.jpg" />

    <!-- SPIRIT TITLE -->
    <title>Spirit 2021 | Event Registration</title>
	   <link rel="stylesheet" href="../../public/css/events_style.css" />
		<style>
			body {
  margin: 0% 0%;
  padding: 0% 0%;
}
#root {
  height: 100%;
  margin: 0% 0%;
  padding: 0% 0%;
}
.leftDiv {
  position: relative;
  top: 0px;
  float: left;
  width: 58%;
  height: 100vh;
  overflow-y: auto;
  background: #c567ff;
}
.rightDiv {
  position: relative;
  float: left;
  width: 42%;
  height: 100vh;
  overflow-y: auto;
  background: #0a0a0a;
}
.img1 {
  width: 100%;
  height: 34vh;
  background-image: url('/images/Iplcard.png');
  background-repeat: no-repeat;
  background-size: 100% 100%;
}
.img2 {
  width: 100%;
  height: 34vh;
  background-image: url('/images/Shutterbugcard.png');
  background-repeat: no-repeat;
  background-size: 100% 100%;
}
.titleRow {
  width: 100%;
  padding-top: 3.6%;
  display: inline-block;
}
.title {
  position: relative;
  float: left;
  width: fit-content;
  margin-left: 4.3%;
  font-family: "Poppins", sans-serif;
  font-style: normal;
  font-weight: 600;
  font-size: x-large;
  color: #0a0a0a;
}
.date {
  position: relative;
  float: right;
  width: fit-content;
  margin-right: 7.3%;
  font-family: "Poppins", sans-serif;
  font-style: normal;
  font-weight: 600;
  font-size: 3.3vh;
  color: #0a0a0a;
}
.description {
  position: relative;
  display: inline-block;
  width: 89.4%;
  height: fit-content;
  padding-top: 5.5%;
  padding-left: 4.2%;
  padding-right: 6.4%;
  padding-bottom: 3.3%;
  justify-content: center;
  font-family: "Poppins", sans-serif;
  font-style: normal;
  font-weight: normal;
  font-size: 2.8vh;
  color: #0a0a0a;
}
.row {
  width: 100%;
  height: fit-content;
  margin-bottom: 2.6vh;
  display: inline-block;
}
.leftRow {
  float: left;
  width: 43%;
  margin-left: 4.2%;
  font-family: Poppins;
  font-style: normal;
  font-weight: normal;
  font-size: 3.3vh;
  color: #0a0a0a;
}
.rightRow {
  float: left;
  width: 13.9%;
  margin-left: 24.1%;
  font-family: Poppins;
  font-style: normal;
  font-weight: normal;
  font-size: 3.3vh;
  text-align: right;
  color: #0a0a0a;
}
.registerTitle {
  width: 17.4%;
  height: 3.7vh;
  margin-left: 21.1%;
  margin-top: 15vh;
  margin-bottom: 6vh;
  font-family: Inter;
  font-style: normal;
  font-weight: bold;
  font-size: 3.1vh;
  color: #ffffff;
}
.registerTitle_2 {
  width: 20%;
  height: 3.7vh;
  margin-left: 21.1%;
  margin-top: 15vh;
  margin-bottom: 6vh;
  font-family: Inter;
  font-style: normal;
  font-weight: bold;
  font-size: 2.7vh;
  color: #ffffff;
}
.formFieldRow {
  height: 4.4vh;
  width: 100%;
  margin-bottom: 3.1vh;
}
.demo{
   width: 80%;
	height: 4vh;
	font-family: Inter;
  font-style: normal;
  font-weight: 600;
  font-size: 1.6vh;
  line-height: 2vh;
color: rgba(255, 255, 255, 0.8);
}
			
.formFieldLabel {
  float: left;
  width: 14.7%;
  height: 4vh;
  margin-left: 21.1%;
  font-family: Inter;
  font-style: normal;
  font-weight: 600;
  font-size: 1.6vh;
  line-height: 2vh;
  text-align: right;
  color: rgba(255, 255, 255, 0.8);
}
.formFieldInput {
  float: left;
  width: 38.4%;
  height: 4.4vh;
  margin-left: 2.4%;
  color: rgba(255, 255, 255);
  border: 1px solid rgb(255, 255, 255);
  box-sizing: border-box;
  box-shadow: inset 0px -1px 5px rgba(0, 0, 0, 0);
  border-radius: 8px;
  background-color: rgba(0, 0, 0);
}
.formSubmit {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 1.8vh 20%;
  width: 37.4%;
  height: 5.7vh;
  margin-left: 38.4%;
  margin-top: 5.7vh;
  margin-bottom: 23.1vh;
  background: #c567ff;
  border-radius: 8px;
  font-family: Inter;
  font-style: normal;
  font-weight: 600;
  font-size: 1.6vh;
  color: #0a0a0a;
}
@media screen and (max-device-width: 600px) {
  #root {
    overflow-y: auto;
  }
  .leftDiv,
  .rightDiv {
    height: fit-content;
    width: 100%;
    margin-left: 0;
  }
}
@media screen and (max-device-width: 480px) {
  .title,
  .date {
    font-size: 20px;
  }
  .description {
    font-size: 18.5px;
  }
  .leftRow,
  .rightRow {
    font-size: 17px;
  }
}
.prize{
	text-align: center;
	font-size:x-large;
	font-family: "Poppins", sans-serif;
}
		</style>
    </head>
    <body>
        <div class="root">
			<div class="leftDiv">
				<%if (name==="iplauction"){%>
				<div id="IplAuction1">
					<div class="img1"></div>
					<div class="titleRow">
						<div class="title">IPL Auction</div>
						<div class="date"> 9-10 Oct</div>
					</div>
					<div class="description">
						Auctions make noteworthy value disclosure and liquidity, bringing about an extremely significant 													last sale cost. In case you were building a protection trade today, an auction would be a 															central component. Spirit, IIT Guwahati will lead a fun IPL auction. This occasion requires no 														essential information, just sharp and insightful sales abilities to outmaneuver your rivals.
					</div>
					<div class="prize"><b>Prize Pool of 20k</b></div>
				</div>
				<%}else if (name==="shutterbug"){%>
				<div id="Shutterbug1">
					<div class="img2"></div>
					<div class="titleRow">
						<div class="title">ShutterBug</div>
						<div class="date"> 8-14 Oct</div>
					</div>
					<div class="description">
						It is easy to access online free stock, but it's hard to find anything that truly represents the 													diversity that exists in our society‚Äù. Spirit 2021 brings an online competition where you 															   showcase your sports photography skills to get exciting prizes and compete with some of the best                                                        photographers across the country.
					</div>
					<div class="prize"><b>Prize Pool of 5k</b></div>
				</div>
				<%}%>
			</div>
			<div class="rightDiv">
				<div class="registerTitle">Register</div>
				<form id="event-form" method="POST" >
					<%if (name==="iplauction"){%>
					<%- include('event_reg_forms/iplauctionform') -%>
        			<%}else if (name==="shutterbug"){%>
					<%- include('event_reg_forms/shutterbugform') -%>
            		<%}%>
				</form>
			</div>
		</div>
		
	<script>
		var event_name = '<%=name%>'
		if (event_name === "shutterbug"){
			console.log('entered here');
			var form = document.getElementById('event-form')
			form.addEventListener('submit', registerForm)
			async function registerForm(event) {
				event.preventDefault()
				let id = '<%=user._id%>'					
				var full_name = document.getElementById('full_name').value
				var email_address = document.getElementById('email_address').value
				var college = document.getElementById('college').value
				var contact_number = document.getElementById('contact_number').value
        var amb_id = document.getElementById('amb_id').value
				var result = await fetch(`/events/event_registration/post/${event_name}/${id}`, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						full_name,event_name,email_address,college,contact_number,amb_id
					})
				}).then((res) => res.json())

				if (result.status === 'ok') {
					window.location.replace(`/events/event_registration/success`);
					alert('Success')
				} else {
					window.location.replace(`/`);
					alert(result.error)
				}
		}}
		else if(event_name === "iplauction"){
				var form = document.getElementById('event-form')
				form.addEventListener('submit', registerForm2)

				async function registerForm2(event){
					event.preventDefault();
					const memb1 =await registerUser(1);
					const memb2 =await registerUser(2);
					const memb3 =await registerUser(3);
          const amb_id = document.getElementById('amb_id').value;
					const result=await registerForEvent(memb1,memb2,memb3);
				};

				async function registerUser(i) {
          const amb_id = document.getElementById('amb_id').value;
          const name = document.getElementById(`full_name${i}`).value;
					const email = document.getElementById(`email_address${i}`).value;
					const discord = document.getElementById(`discord${i}`).value;
					const result = await fetch(`/events/event_registration/post_ipl`, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
            name,
						email,
						discord,
            amb_id
					})
					}).then((res) => res.json())
					if (result.status === 'ok') {
					return result.data
					
					} else {
					window.location.replace(`/`);
					alert(result.error)
					}
				};

				async function registerForEvent(member1,member2,member3) {
					const teamname = document.getElementById("team_name").value;
					const result = await fetch(`/iplauction/register`, {
						method: 'POST',
						headers: {
						'Content-Type': 'application/json'
						},
						body: JSON.stringify({
						member1, member2, member3,teamname
						})
					}).then((res) => res.json())
					if (result.status === 'ok') {
						window.location.replace(`/events/event_registration/success`);
						alert('Success')
					} else {
						window.location.replace(`/`);
						alert(result.error)
					}
				};			
			
		}
	
    </script>

    </body>
</html>